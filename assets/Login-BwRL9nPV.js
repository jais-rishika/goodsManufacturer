import{o as _,s as L,u as S,r as a,j as e,y as d,a as x,b as y,I as m,B as f}from"./index-D1Wk5fvR.js";import{l as j,r as g,g as v}from"./auth.service-Ch6fXiXU.js";const I="_LoginPage_1h8vt_2",N="_LoginLeftSide_1h8vt_8",E="_LoginRightSide_1h8vt_15",w="_LoginForm_1h8vt_21",i={LoginPage:I,LoginLeftSide:N,LoginRightSide:E,LoginForm:w},F=_({email:L({invalid_type_error:"Email must be String",message:"Invalid Email"}).min(5,{message:"Email should be atleast of length 5"}).email("Invalid Email"),password:L({invalid_type_error:"Password must be String"}).min(4,{message:"Password should be atleast of length 4"})}),O={isLoading:!1,error:""},b=(s,t)=>{switch(t.type){case"ON_LOGIN":return{...s,isLoading:!0,error:""};case"LOGIN_SUCCESSFUL":return{...s,isLoading:!1,error:""};case"LOGIN_FAILED":return{...s,isLoading:!1,error:t.error}}},h=a.createContext(null),C=s=>t=>{const o=S(),[l,n]=a.useReducer(b,O),u={checkLogin:async()=>{try{const r=(await v()).role;return console.log(r,g[r]),o(`/${g[r]}`)}catch{}},handleLogin:async c=>{try{n({type:"ON_LOGIN"});const r=await j(c);localStorage.setItem("token",r.jwtToken),n({type:"LOGIN_SUCCESSFUL"}),d.success("Login Successful");const p=r.role;o(`/${g[p]}`)}catch(r){n({type:"LOGIN_FAILED",error:r.message}),d.error("Login Failed")}}};return e.jsx(h.Provider,{value:{...l,...u},children:e.jsx(s,{...t})})},G=({})=>{const{register:s,handleSubmit:t,formState:o}=x({resolver:y(F)}),{checkLogin:l,handleLogin:n}=a.useContext(h);return a.useEffect(()=>{l()},[]),e.jsxs("div",{className:i.LoginPage,children:[e.jsx("div",{className:i.LoginLeftSide}),e.jsx("div",{className:i.LoginRightSide,children:e.jsxs("form",{className:i.LoginForm,onSubmit:t(n),children:[e.jsx("h1",{children:"LOGIN"}),e.jsx(m,{type:"email",placeholder:"Enter Email...",...s("email")}),o.errors.email&&e.jsx("small",{children:o.errors.email.message}),e.jsx(m,{type:"password",placeholder:"Enter Password...",...s("password")}),o.errors.password&&e.jsx("small",{children:o.errors.password.message}),e.jsx(f,{type:"submit",primary:!0,children:"LOGIN"})]})})]})},T=C(G);export{T as default};
