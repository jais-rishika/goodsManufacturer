import{z as L,c as j,r as u,j as e,B as D,h as z,k as B,a as N,b as R,M as W,S as U,y,I as $,d as H,T as q,P as Y}from"./index-q3AqL9l-.js";import{b as J}from"./worker.service-Ct5Zt7gX.js";const K="_Form_1dq9l_1",b={Form:K},O=L.object({name:L.string({invalid_type_error:"Name must be String"}).min(2,{message:"name should contain atleast 2 chars"}).optional(),workerEmail:L.string().optional()}),Q={isLoading:!1,error:"",addModal:!1,deleteModal:!1,editModal:!1,selected:null,workStationTableData:[],availFields:[],selectedManager:null,selectedFilters:[],searchValue:"",count:0,urlFilter:"page=0&size=5"},X=(t,a)=>{switch(a.type){case"ADD_MODAL":return{...t,addModal:a.status};case"EDIT_MODAL":return{...t,editModal:a.status};case"DELETE_MODAL":return{...t,deleteModal:a.status};case"GET_DATA":return{...t,isLoading:!0,error:""};case"GET_DATA_FAILED":return{...t,isLoading:!1,error:a.error};case"GET_DATA_SUCCESS":return{...t,isLoading:!1,workStationTableData:a.data};case"SELECT":return{...t,selected:a.selected};case"SET_AVAIL_FIELDS":return{...t,availFields:a.data};case"SET_MANAGER":return{...t,selectedManager:a.data};case"SET_COUNT":return{...t,count:a.count};case"SET_FILTERS":return{...t,selectedFilters:a.data};case"SET_SEARCH":return{...t,searchValue:a.data};case"SET_URL_FILTER":return{...t,urlFilter:a.data};default:return{...t}}},Z=async t=>{try{return(await j.get(`/workplace-manager/workstation?${t}`)).data}catch(a){throw a}},ee=async t=>{try{return(await j.post("/workplace-manager/workstation",t)).data}catch(a){throw a}},te=async(t,a)=>{try{return(await j.patch(`/workplace-manager/workstation/${a}`,t)).data}catch(r){throw r}},ae=async t=>{try{return(await j.delete(`/workplace-manager/workstation/${t}`)).data}catch(a){throw a}},A=u.createContext(null),re=t=>a=>{const[r,s]=u.useReducer(X,Q),l=()=>{s({type:"ADD_MODAL",status:!r.addModal})},E=()=>{s({type:"EDIT_MODAL",status:!0})},S=()=>{s({type:"EDIT_MODAL",status:!1})},m=()=>{s({type:"DELETE_MODAL",status:!0})},k=()=>{s({type:"DELETE_MODAL",status:!1})},h=o=>{s({type:"SELECT",selected:o})},n=async o=>{const i=await J(o);console.log(i),s({type:"SET_AVAIL_FIELDS",data:i.data})},c=async o=>{s({type:"SET_MANAGER",data:o})},d=o=>{s({type:"SET_FILTERS",data:o})},T=(o,i)=>{const g=new URLSearchParams(r.urlFilter);g.set("size",`${o}`),g.set("page",`${i}`),F(g.toString())},w=o=>{s({type:"SET_SEARCH",data:o})},F=o=>{const i=new URLSearchParams(o),[g,x]=[i.get("size"),i.get("page")],_=new URLSearchParams;_.set("page",`${x}`),_.set("size",`${g}`),_.set("search",r.searchValue||"");const G=r.selectedFilters.reduce((P,v)=>`${P}&fields=${v}`,""),I=_.toString()+G;s({type:"SET_URL_FILTER",data:I}),p(I)},M=o=>{s({type:"SET_COUNT",count:o})},f=o=>e.jsxs(e.Fragment,{children:[e.jsx(D,{primary:!0,onClick:()=>{h(o),E()},children:e.jsx(z,{})}),e.jsx(D,{danger:!0,onClick:()=>{h(o),m()},children:e.jsx(B,{})})]}),p=async o=>{try{s({type:"GET_DATA"});const i=await Z(o);M(i.page.totalElements);const g=i.content.map(x=>({name:x.name,workerName:x.workerName,workerEmail:x.workerEmail,action:f(x)}));s({type:"GET_DATA_SUCCESS",data:g})}catch{s({type:"GET_DATA_FAILED",error:"Could not Fetch the Facilities"})}},V={handleAddModal:l,hideEditModal:S,hideDeleteModal:k,handleSelect:h,getData:p,setAvailFields:n,updateManager:c,updateUrl:F,handleFilterChange:d,handleUrlChange:T,updateSearch:w,setCount:M};return e.jsx(A.Provider,{value:{...r,...V},children:e.jsx(t,{...a})})},se=({})=>{var n;const{availFields:t,setAvailFields:a,handleAddModal:r,getData:s,urlFilter:l,selectedManager:E,updateManager:S}=u.useContext(A),{handleSubmit:m,formState:k}=N({resolver:R(O)}),h=async c=>{E||alert("ADD WorkStation Manager"),console.log("hello"),c.workerEmail=E;try{const d=await ee(c);if(!(d.status>=200&&d.status<300))throw Error("ADD unsuccessfull");r(),s(l),y.success("WorkStation Added ")}catch{y.error("Sorry!! WorkStation Could not be Added")}};return u.useEffect(()=>{a("")},[]),e.jsx(W,{setShowModal:r,children:e.jsxs("form",{onSubmit:m(h),className:b.Form,children:[e.jsx("h2",{children:"Add WorkPlace"}),e.jsx(U,{setFieldValue:S,availFields:t,setAvailFields:a,toSearch:"Email"}),!!k.errors.workerEmail&&e.jsx("small",{children:(n=k.errors.workerEmail)==null?void 0:n.message}),e.jsx(D,{type:"submit",children:"Add"})]})})},oe=({})=>{const{hideDeleteModal:t,getData:a,selected:r}=u.useContext(A),s=async()=>{try{const l=await ae(r.id);if(!(l.status>=200&&l.status<300))throw Error("DELETE unsuccessfull");a(),y.success("WorkStation Deleted Successfully")}catch{y.error("WorkStation Deletion Failed")}finally{t()}};return e.jsx(W,{setShowModal:t,children:e.jsxs("div",{className:b.DeleteContainer,children:[e.jsx("h2",{children:"Delete WorkStation "}),e.jsx("h5",{children:"Are You sure you want to delete this WorkStation?"}),e.jsx(D,{danger:!0,onClick:s,children:"DELETE"})]})})},le=({})=>{var d;const{hideEditModal:t,getData:a,selected:r,availFields:s,setAvailFields:l,urlFilter:E,selectedManager:S,updateManager:m}=u.useContext(A);console.log(r);const{register:k,handleSubmit:h,formState:n}=N({defaultValues:{name:`${r.name}`,workerEmail:`${r.workerEmail}`},resolver:R(O)}),c=async T=>{T.workerEmail=S||r.workerEmail;try{const w=await te(T,r.id);if(!(w.status>=200&&w.status<300))throw Error("EDIT unsuccessfull");a(E),y.success("WorkStation  Edited ")}catch{y.error("Sorry!! WorkStation  Could not be Edited")}finally{t()}};return u.useEffect(()=>{l(""),m(r.workerEmail)},[]),e.jsx(W,{setShowModal:t,children:e.jsxs("form",{onSubmit:h(c),className:b.Form,children:[e.jsx("h2",{children:"Edit WorkStation"}),e.jsx($,{placeholder:"Enter WorkStation Name",...k("name")}),!!n.errors.name&&e.jsx("small",{children:n.errors.name.message}),e.jsx(U,{setFieldValue:m,availFields:s,setAvailFields:l,toSearch:"Email",selectedField:r.workerEmail}),!!n.errors.workerEmail&&e.jsx("small",{children:(d=n.errors.workerEmail)==null?void 0:d.message}),e.jsx(D,{type:"submit",children:"Edit"})]})})},ne="_Top_1kw61_1",ce="_Filter_1kw61_8",ie="_Table_1kw61_36",C={Top:ne,Filter:ce,Table:ie},de=({})=>{const{getData:t,handleAddModal:a,addModal:r,deleteModal:s,editModal:l,workStationTableData:E,selected:S,updateUrl:m,searchValue:k,selectedFilters:h,count:n,urlFilter:c,handleUrlChange:d,handleFilterChange:T,updateSearch:w}=u.useContext(A),F=u.useRef(null),M=[{id:"name",label:"WorkStation Name"},{id:"workerName",label:"WorkStation Manager Name"},{id:"workerEmail",label:"WorkStation Manager Email"},{id:"action",label:"Actions"}],f=()=>{m(c)};return u.useEffect(()=>{t(c)},[]),e.jsxs("div",{children:[e.jsxs("div",{className:C.Top,children:[e.jsx("div",{children:e.jsxs("div",{className:C.Filter,children:[e.jsx("label",{children:e.jsx(H,{selectedFilters:h,handleFilter:T,availFilters:["workerName","workerEmail","name"],getData:t,url:c})}),e.jsx($,{type:"text",placeholder:"search",ref:F,defaultValue:k,onChange:p=>w(p.target.value)}),e.jsx(D,{primary:!0,onClick:f,children:"Filter"})]})}),e.jsx(D,{primary:!0,onClick:a,children:"Add WorkStation"})]}),e.jsx("div",{className:C.Table,children:e.jsx(q,{tableData:E,columnData:M})}),e.jsx(Y,{count:n,url:c,setUrl:d,getData:t}),r&&e.jsx(se,{}),S&&l&&e.jsx(le,{}),s&&e.jsx(oe,{})]})},Ee=re(de);export{Ee as default};
