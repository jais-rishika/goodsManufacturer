import{r as d,j as t,d as f,I as x,B as L,T as U,P as R}from"./index-BWAck-FT.js";import{g as b}from"./owner.service-Df99n_Z4.js";const j="_Top_lnnrr_1",D="_Filter_lnnrr_8",w="_Table_lnnrr_39",F={Top:j,Filter:D,Table:w},I={isLoading:!1,error:"",selected:null,AllEmployeeTableData:[],selectedFilters:[],searchValue:"",count:0,urlFilter:"page=0&size=5"},N=(a,l)=>{switch(l.type){case"GET_DATA":return{...a,isLoading:!0,error:""};case"GET_DATA_FAILED":return{...a,isLoading:!1,error:l.error};case"GET_DATA_SUCCESS":return{...a,isLoading:!1,AllEmployeeTableData:l.data};case"SELECT":return{...a,selected:l.selected};case"SET_COUNT":return{...a,count:l.count};case"SET_FILTERS":return{...a,selectedFilters:l.data};case"SET_SEARCH":return{...a,searchValue:l.data};case"SET_URL_FILTER":return{...a,urlFilter:l.data};default:return a}},S=d.createContext(null),P=a=>l=>{const[i,o]=d.useReducer(N,I),h=e=>{o({type:"SELECT",selected:e})},T=e=>{const r=e.includes("email"),s=e.filter(n=>n!=="email");s.length>1&&s.splice(0,1),r&&s.push("email"),o({type:"SET_FILTERS",data:s})},u=(e,r)=>{const s=new URLSearchParams(i.urlFilter);s.set("size",`${e}`),s.set("page",`${r}`),m(s.toString())},g=e=>{o({type:"SET_SEARCH",data:e})},m=e=>{const r=new URLSearchParams(e),[s,n]=[r.get("size"),r.get("page")],c=new URLSearchParams;c.set("page",`${n}`),c.set("size",`${s}`),i.selectedFilters.includes("email")&&c.set("email",i.searchValue);const A=i.selectedFilters.filter(y=>y!=="email");if(A.length>0){const y=`ROLE_${A[0].toUpperCase()}`;c.set("role",y)}const C=c.toString();o({type:"SET_URL_FILTER",data:C}),p(C)},E=e=>{o({type:"SET_COUNT",count:e})},p=async e=>{try{o({type:"GET_DATA"});const r=await b(e);E(r.page.totalElements);const s=r.content.map(n=>({name:n.name,email:n.email,role:n.role.split("_")[1],location:[n.facilityName,n.workplaceName,n.workStationCode,n.toolCribName].filter(c=>c??c).join(" , ")}));o({type:"GET_DATA_SUCCESS",data:s})}catch{o({type:"GET_DATA_FAILED",error:"Could not Fetch the Employees"})}},_={handleSelect:h,getData:p,updateUrl:m,handleFilterChange:T,handleUrlChange:u,updateSearch:g,setCount:E};return t.jsx(S.Provider,{value:{...i,..._},children:t.jsx(a,{...l})})},G=({})=>{const a=d.useRef(null),{getData:l,AllEmployeeTableData:i,searchValue:o,selectedFilters:h,count:T,urlFilter:u,updateUrl:g,handleUrlChange:m,handleFilterChange:E,updateSearch:p}=d.useContext(S),_=[{id:"name",label:"Employee Name"},{id:"email",label:"Employee Email"},{id:"role",label:"Role"},{id:"location",label:"Location"}],e=()=>{g(u)};return d.useEffect(()=>{l(u)},[]),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:F.Top,children:t.jsx("div",{children:t.jsxs("div",{className:F.Filter,children:[t.jsx("label",{children:t.jsx(f,{selectedFilters:h,handleFilter:E,availFilters:["worker","owner","facilitymanager","workplacemanager","toolcribmanager","email"],getData:l,url:u})}),t.jsx(x,{type:"text",placeholder:"search",ref:a,defaultValue:o,onChange:r=>p(r.target.value)}),t.jsx(L,{primary:!0,onClick:e,children:"Filter"})]})})}),t.jsx("div",{className:F.Table,children:t.jsx(U,{tableData:i,columnData:_})}),t.jsx(R,{count:T,setUrl:m,url:u,getData:l})]})},z=P(G);export{z as default};
