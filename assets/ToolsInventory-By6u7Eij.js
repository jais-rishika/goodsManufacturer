import{u as D,r as t,j as e,d as L,I as i,B as o,C as U,i as A,P as B,T as O,y as p}from"./index-q3AqL9l-.js";import{w as J,T as V,R as Y}from"./ReqToolModal-Bngf7aOb.js";import{s as $}from"./Requests.service-CpeZvalB.js";const z="_Top_17k6i_1",G="_Filter_17k6i_8",H="_PriceFilter_17k6i_34",K="_MainContainer_17k6i_39",W="_ToolsCard_17k6i_57",X="_RemoveReq_17k6i_68",Z="_Line_17k6i_78",r={Top:z,Filter:G,PriceFilter:H,MainContainer:K,ToolsCard:W,RemoveReq:X,Line:Z},ee=({})=>{const j=D(),h=t.useRef(null),{ToolInventoryData:x,reqToolModal:m,reqTableData:c,showReqToolModal:v,getData:d,setSelected:y,updateReqTable:u,searchValue:T,selectedFilters:g,count:b,urlFilter:a,updateUrl:R,handleUrlChange:C,handleFilterChange:q,updateSearch:f,updateMaxPrice:P,updateMinPrice:_}=t.useContext(V),F=()=>{R(a)},I=s=>{const n=+s.target.value;console.log(n),n<1?(alert("Min value can't be less than 1"),s.target.value=""):_(n)},k=s=>{const n=+s.target.value;n<1?(alert("Max value can't be less than 1"),s.target.value=""):P(n)},M=s=>{y(s),v()};t.useEffect(()=>{d(a)},[]),t.useEffect(()=>{const s=JSON.parse(localStorage.getItem("reqTable")||JSON.stringify([]));u(s)},[]);const N=[{id:"id",label:"Item ID."},{id:"name",label:"Tool Name"},{id:"qty",label:"Quantity"}],Q=()=>{const n=h.current.value,l=[...c],E=l.findIndex(w=>w.id===n);l.splice(E,1),u(l)},S=async()=>{const s=c.map(l=>({toolId:l.id,reqQuantity:l.qty})),n={items:s};console.log(s);try{const l=await $(n);if(!(l.status>=200&&l.status<300))throw Error("Fetch unsuccessfull");p.success("Request Added"),localStorage.removeItem("reqTable"),j("/worker/requests")}catch{p.error("Request Failed")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:r.MainContainer,children:[e.jsxs("div",{children:[e.jsx("div",{className:r.Top,children:e.jsx("div",{children:e.jsxs("div",{className:r.Filter,children:[e.jsx("label",{children:e.jsx(L,{selectedFilters:g,handleFilter:q,availFilters:["name","special","normal","isPerishable"],getData:d,url:a})}),e.jsx(i,{type:"text",placeholder:"search",defaultValue:T,onChange:s=>f(s.target.value)}),e.jsxs("div",{className:r.PriceFilter,children:[e.jsx(i,{placeholder:"MinPrice",type:"number",min:1,onChange:I,className:r.Price}),e.jsx(i,{placeholder:"MaxPrice",type:"number",min:1,onChange:k,className:r.Price})]}),e.jsx(o,{primary:!0,onClick:F,children:"Filter"})]})})}),e.jsxs("div",{className:r.ToolsCard,children:[x.length>0&&x.map(s=>e.jsxs(U,{id:s.toolId,photo:s.toolImageUrl||A,children:[e.jsxs("p",{children:[e.jsx("span",{children:"Name:"}),e.jsx("span",{children:s.toolName})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Fine:"}),e.jsx("span",{children:s.fineAmount})]}),!s.isPerishable&&e.jsxs("p",{children:[e.jsx("span",{children:"Return Period:"}),e.jsx("span",{children:s.returnPeriod})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Category:"}),e.jsx("span",{children:s.toolCategory})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Perishable:"}),e.jsx("span",{children:s.isPerishable?"YES":"NO"})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:s.totalQuantity})]}),e.jsx("div",{className:r.Line}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("span",{children:"Allocated:"}),e.jsx("span",{children:s.totalQuantity-s.availableQuantity-s.brokenQuantity?s.brokenQuantity:0})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Pending:"}),e.jsx("span",{children:s.availableQuantity})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Broken:"}),e.jsx("span",{children:s.brokenQuantity?s.brokenQuantity:0})]})]}),e.jsx(o,{primary:!0,onClick:()=>M(s),children:"REQ Tool"})]})),e.jsx(B,{count:b,setUrl:C,url:a,getData:d})]})]}),e.jsxs("div",{className:r.Request,children:[e.jsxs("div",{className:r.RemoveReq,children:[e.jsx(i,{placeholder:"Remove item id.",type:"number",ref:h}),e.jsx(o,{danger:!0,onClick:Q,children:"Remove"})]}),e.jsx(O,{columnData:N,tableData:c,children:e.jsx("tr",{children:e.jsx("td",{colSpan:3,children:e.jsx(o,{onClick:S,children:"Send REQ"})})})})]})]}),m&&e.jsx(Y,{})]})},re=J(ee);export{re as default};
