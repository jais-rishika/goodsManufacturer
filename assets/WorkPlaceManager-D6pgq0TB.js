import{z as S,r as g,j as e,p as $,B as x,h as V,k as z,a as W,b as U,M as b,I as F,q as G,y as D,t as v,v as B,d as H,T as q,P as J}from"./index-D1Wk5fvR.js";const Y="_Form_ecg43_1",K="_DeleteContainer_ecg43_8",P={Form:Y,DeleteContainer:K},R=S.object({name:S.string({invalid_type_error:"Email must be String"}).min(2,{message:"name should contain atleast 2 chars"}),email:S.string({invalid_type_error:"location must be String"}).min(5,{message:"email should contain atleast 2 chars"}).email("INVALID_EMAIL")}),Q={isLoading:!1,error:"",addModal:!1,editModal:!1,deleteModal:!1,selected:null,workPlaceManagerTableData:[],selectedFilters:[],searchValue:"",count:0,urlFilter:"page=0&size=5"},X=(r,s)=>{switch(s.type){case"ADD_MODAL":return{...r,addModal:s.status};case"EDIT_MODAL":return{...r,editModal:s.status};case"DELETE_MODAL":return{...r,deleteModal:s.status};case"GET_DATA":return{...r,isLoading:!0,error:""};case"GET_DATA_FAILED":return{...r,isLoading:!1,error:s.error};case"GET_DATA_SUCCESS":return{...r,isLoading:!1,workPlaceManagerTableData:s.data};case"SELECT":return{...r,selected:s.selected};case"SET_COUNT":return{...r,count:s.count};case"SET_FILTERS":return{...r,selectedFilters:s.data};case"SET_SEARCH":return{...r,searchValue:s.data};case"SET_URL_FILTER":return{...r,urlFilter:s.data};default:return{...r}}},y=g.createContext(null),Z=r=>s=>{const[a,t]=g.useReducer(X,Q),c=()=>{t({type:"ADD_MODAL",status:!a.addModal})},n=()=>{t({type:"EDIT_MODAL",status:!0})},i=()=>{t({type:"DELETE_MODAL",status:!0})},u=()=>{t({type:"EDIT_MODAL",status:!1})},h=()=>{t({type:"DELETE_MODAL",status:!1})},o=l=>{t({type:"SELECT",selected:l})},d=l=>{t({type:"SET_FILTERS",data:l})},j=(l,m)=>{const E=new URLSearchParams(a.urlFilter);E.set("size",`${l}`),E.set("page",`${m}`),T(E.toString())},A=l=>{t({type:"SET_SEARCH",data:l})},T=l=>{const m=new URLSearchParams(l),[E,M]=[m.get("size"),m.get("page")],_=new URLSearchParams;_.set("page",`${M}`),_.set("size",`${E}`),a.searchValue&&_.set("search",a.searchValue||"");const I=a.selectedFilters.reduce((N,O)=>`${N}&fields=${O}`,""),w=_.toString()+I;t({type:"SET_URL_FILTER",data:w}),p(w)},f=l=>{t({type:"SET_COUNT",count:l})},C=l=>e.jsxs(e.Fragment,{children:[e.jsx(x,{primary:!0,onClick:()=>{o(l),n()},children:e.jsx(V,{})}),e.jsx(x,{danger:!0,onClick:()=>{o(l),i()},children:e.jsx(z,{})})]}),p=async l=>{try{t({type:"GET_DATA"});const m=await $(l);console.log(m);const E=m.content.map(M=>({name:M.name,email:M.email,createdAt:M.createdAt.substring(0,10),workplaceName:M.workplaceName,action:C(M)}));t({type:"GET_DATA_SUCCESS",data:E})}catch{t({type:"GET_DATA_FAILED",error:"Could not Fetch the WorkPlace Managers"})}},k={handleAddModal:c,hideEditModal:u,hideDeleteModal:h,handleSelect:o,getData:p,updateUrl:T,handleFilterChange:d,handleUrlChange:j,updateSearch:A,setCount:f};return e.jsx(y.Provider,{value:{...a,...k},children:e.jsx(r,{...s})})},ee=({})=>{var u;const{handleAddModal:r,getData:s,urlFilter:a}=g.useContext(y),{register:t,handleSubmit:c,formState:n}=W({resolver:U(R)}),i=async h=>{try{const o=await G(h);if(!(o.status>=200&&o.status<300))throw Error("Fetch unsuccessfull");r(),s(a),D.success("Facility Manager Added ")}catch{D.error("Sorry!! Facility Manager Could not be Added")}};return e.jsx(b,{setShowModal:r,children:e.jsxs("form",{onSubmit:c(i),className:P.Form,children:[e.jsx("h2",{children:"Add WorkPlace Manager"}),e.jsx(F,{type:"text",placeholder:"Enter name",...t("name")}),!!n.errors.name&&e.jsx("small",{children:n.errors.name.message}),e.jsx(F,{type:"email",placeholder:"Enter email",...t("email")}),!!n.errors.email&&e.jsx("small",{children:(u=n.errors.email)==null?void 0:u.message}),e.jsx(x,{type:"submit",children:"Add"})]})})},ae=({})=>{const{hideDeleteModal:r,getData:s,selected:a,urlFilter:t}=g.useContext(y),c=async()=>{try{const n=await v(a==null?void 0:a.id);if(!(n.status>=200&&n.status<300))throw Error("Fetch unsuccessfull");s(t),D.success("WorkPlace Manager Deleted Successfully")}catch{D.error("WorkPlace Manager Deletion Failed")}finally{r()}};return e.jsx(b,{setShowModal:r,children:e.jsxs("div",{className:P.DeleteContainer,children:[e.jsx("h2",{children:"Delete WorkPlace Manager"}),e.jsx("h5",{children:"Are You sure you want to delete this WorkPlace Manager?"}),e.jsx(x,{danger:!0,onClick:c,children:"DELETE"})]})})},re=({})=>{var h;const{hideEditModal:r,getData:s,selected:a,urlFilter:t}=g.useContext(y),{register:c,handleSubmit:n,formState:i}=W({defaultValues:{name:`${a==null?void 0:a.name}`,email:`${a==null?void 0:a.email}`},resolver:U(R)}),u=async o=>{try{const d=await B(o,a==null?void 0:a.id);if(!(d.status>=200&&d.status<300))throw Error("Fetch unsuccessfull");s(t),D.success("Facility Manager Edited ")}catch{D.error("Sorry!! Facility Manager Could not be Edited")}finally{r()}};return e.jsx(b,{setShowModal:r,children:e.jsxs("form",{onSubmit:n(u),className:P.Form,children:[e.jsx("h2",{children:"Edit WorkPlace Manager"}),e.jsx(F,{placeholder:"Enter Facility Name",...c("name")}),!!i.errors.name&&e.jsx("small",{children:i.errors.name.message}),e.jsx(F,{placeholder:"Enter Facility Email",...c("email")}),!!i.errors.email&&e.jsx("small",{children:(h=i.errors.email)==null?void 0:h.message}),e.jsx(x,{type:"submit",children:"Edit"})]})})},te="_Top_1s5pg_1",se="_Filter_1s5pg_8",le="_Table_1s5pg_40",L={Top:te,Filter:se,Table:le},ne=({})=>{const r=g.useRef(null),{handleAddModal:s,getData:a,addModal:t,deleteModal:c,editModal:n,workPlaceManagerTableData:i,searchValue:u,selectedFilters:h,count:o,urlFilter:d,updateUrl:j,handleUrlChange:A,handleFilterChange:T,updateSearch:f}=g.useContext(y),C=[{id:"name",label:"Workplace Manager Name"},{id:"email",label:"Workplace Manager Email"},{id:"createdAt",label:"Joined ON"},{id:"workplaceName",label:"WorkPlace"},{id:"action",label:"Actions"}],p=()=>{j(d)};return g.useEffect(()=>{a(d)},[]),e.jsxs("div",{children:[e.jsxs("div",{className:L.Top,children:[e.jsx("div",{children:e.jsxs("div",{className:L.Filter,children:[e.jsx("label",{children:e.jsx(H,{selectedFilters:h,handleFilter:T,availFilters:["name","email"],getData:a,url:d})}),e.jsx(F,{type:"text",placeholder:"search",ref:r,defaultValue:u,onChange:k=>f(k.target.value)}),e.jsx(x,{primary:!0,onClick:p,children:"Filter"})]})}),e.jsx(x,{primary:!0,onClick:s,children:"Add WorkPlace Manager"})]}),e.jsx("div",{className:L.Table,children:e.jsx(q,{tableData:i,columnData:C})}),e.jsx(J,{count:o,setUrl:A,url:d,getData:a}),t&&e.jsx(ee,{}),n&&e.jsx(re,{}),c&&e.jsx(ae,{})]})},ce=Z(ne);export{ce as default};
