import{z as L,c as A,r as y,j as e,B as F,h as z,k as G,a as I,b as N,M as w,I as D,y as x,d as v,T as B,P as H}from"./index-C3qfdU6q.js";const J="_Top_lnnrr_1",Y="_Filter_lnnrr_8",q="_Table_lnnrr_39",b={Top:J,Filter:Y,Table:q},K="_Form_ecg43_1",Q="_DeleteContainer_ecg43_8",U={Form:K,DeleteContainer:Q},$=L.object({name:L.string({invalid_type_error:"Email must be String"}).min(2,{message:"name should contain atleast 2 chars"}),email:L.string({invalid_type_error:"location must be String"}).min(5,{message:"email should contain atleast 2 chars"}).email("INVALID_EMAIL")}),W=async t=>{try{const a=await A.get(`/owner/facility-manager?${t}`);return console.log(a),a.data}catch(a){throw a}},X=async t=>{try{return(await A.post("/owner/facility-manager",t)).data}catch(a){throw a}},Z=async(t,a)=>{try{return(await A.patch(`/owner/facility-manager/${a}`,t)).data}catch(s){throw s}},ee=async t=>{try{return(await A.delete(`owner/facility-manager/${t}`)).data}catch(a){throw a}},ae={isLoading:!1,error:"",addModal:!1,editModal:!1,deleteModal:!1,selected:null,facilityManagerTableData:[],selectedFilters:[],searchValue:"",count:0,urlFilter:"page=0&size=5"},te=(t,a)=>{switch(a.type){case"ADD_MODAL":return{...t,addModal:a.status};case"EDIT_MODAL":return{...t,editModal:a.status};case"DELETE_MODAL":return{...t,deleteModal:a.status};case"GET_DATA":return{...t,isLoading:!0,error:""};case"GET_DATA_FAILED":return{...t,isLoading:!1,error:a.error};case"GET_DATA_SUCCESS":return{...t,isLoading:!1,facilityManagerTableData:a.data};case"SELECT":return{...t,selected:a.selected};case"SET_COUNT":return{...t,count:a.count};case"SET_FILTERS":return{...t,selectedFilters:a.data};case"SET_SEARCH":return{...t,searchValue:a.data};case"SET_URL_FILTER":return{...t,urlFilter:a.data};default:return t}},j=y.createContext(null),re=t=>a=>{const[s,r]=y.useReducer(te,ae),i=()=>{r({type:"ADD_MODAL",status:!s.addModal})},n=()=>r({type:"EDIT_MODAL",status:!0}),c=()=>r({type:"EDIT_MODAL",status:!1}),d=()=>r({type:"DELETE_MODAL",status:!0}),u=()=>r({type:"DELETE_MODAL",status:!1}),h=l=>{r({type:"SELECT",selected:l})},M=(l,o)=>{r({type:"SET_FILTERS",data:l});const m=new URLSearchParams(o),[g,O]=[m.get("size"),m.get("page")],_=new URLSearchParams;_.set("page",`${O}`),_.set("size",`${g}`),s.searchValue&&_.set("search",s.searchValue||"");const P=l.reduce((V,k)=>`${V}&fields=${k}`,"");f(_.toString()+P)},E=(l,o)=>{const m=new URLSearchParams(s.urlFilter);m.set("size",`${l}`),m.set("page",`${o}`),M(s.selectedFilters,m.toString())},p=l=>{r({type:"SET_SEARCH",data:l});const o=new URLSearchParams(s.urlFilter);o.set("search",l),M(s.selectedFilters,o.toString())},f=l=>{r({type:"SET_URL_FILTER",data:l})},T=l=>{r({type:"SET_COUNT",count:l})},S=l=>e.jsxs(e.Fragment,{children:[e.jsx(F,{primary:!0,onClick:()=>{h(l),n()},children:e.jsx(z,{})}),e.jsx(F,{danger:!0,onClick:()=>{h(l),d()},children:e.jsx(G,{})})]}),C={handleAddModal:i,hideDeleteModal:u,hideEditModal:c,handleSelect:h,getData:async l=>{try{r({type:"GET_DATA"});const o=await W(l);T(o.page.totalElements);const m=o.content.map(g=>({name:g.name,email:g.email,createdAt:g.createdAt.substring(0,10),facilityName:g.facilityName,action:S(g)}));r({type:"GET_DATA_SUCCESS",data:m})}catch{r({type:"GET_DATA_FAILED",error:"Could not Fetch the Facility Managers"})}},handleFilterChange:M,handleUrlChange:E,updateSearch:p,setCount:T};return e.jsx(j.Provider,{value:{...s,...C},children:e.jsx(t,{...a})})},se=({})=>{var d;const{handleAddModal:t,getData:a,urlFilter:s}=y.useContext(j),{register:r,handleSubmit:i,formState:n}=I({resolver:N($)}),c=async u=>{try{await X(u),t(),a(s),x.success("Facility Manager Added ")}catch{x.error("Sorry!! Facility Manager Could not be Added")}};return e.jsx(w,{setShowModal:t,children:e.jsxs("form",{onSubmit:i(c),className:U.Form,children:[e.jsx("h2",{children:"Add Facility Manager"}),e.jsx(D,{type:"text",placeholder:"Enter name",...r("name")}),!!n.errors.name&&e.jsx("small",{children:n.errors.name.message}),e.jsx(D,{type:"email",placeholder:"Enter email",...r("email")}),!!n.errors.email&&e.jsx("small",{children:(d=n.errors.email)==null?void 0:d.message}),e.jsx(F,{type:"submit",children:"Add"})]})})},le=({})=>{const{hideDeleteModal:t,getData:a,selected:s,urlFilter:r}=y.useContext(j),i=async()=>{try{await ee(s.id),a(r),x.success("Facilty Manager Deleted Successfully")}catch{x.error("Facilty Manager Deletion Failed")}finally{t()}};return e.jsx(w,{setShowModal:t,children:e.jsxs("div",{className:U.DeleteContainer,children:[e.jsx("h2",{children:"Delete Facility Manager"}),e.jsx("h5",{children:"Are You sure you want to delete this FacilityManager?"}),e.jsx(F,{danger:!0,onClick:i,children:"DELETE"})]})})},ne=({})=>{var u;const{getData:t,selected:a,urlFilter:s,hideEditModal:r}=y.useContext(j),{register:i,handleSubmit:n,formState:c}=I({defaultValues:{name:`${a.name}`,email:`${a.email}`},resolver:N($)}),d=async h=>{try{await Z(h,a.id),t(s),x.success("Facility Manager Edited ")}catch{x.error("Sorry!! Facility Manager Could not be Edited")}finally{r()}};return e.jsx(w,{setShowModal:r,children:e.jsxs("form",{onSubmit:n(d),className:U.Form,children:[e.jsx("h2",{children:"Edit Facility Manager"}),e.jsxs("div",{children:[e.jsx("label",{children:"Facility Name"}),e.jsx(D,{placeholder:"Enter Facility Name",...i("name")}),!!c.errors.name&&e.jsx("small",{children:c.errors.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Facility Email"}),e.jsx(D,{placeholder:"Enter Facility Email",...i("email")}),!!c.errors.email&&e.jsx("small",{children:(u=c.errors.email)==null?void 0:u.message})]}),e.jsx(F,{type:"submit",children:"Edit"})]})})},ie=({})=>{const t=y.useRef(null),{getData:a,handleAddModal:s,addModal:r,deleteModal:i,editModal:n,facilityManagerTableData:c,selected:d,searchValue:u,selectedFilters:h,count:M,urlFilter:E,handleUrlChange:p,handleFilterChange:f,updateSearch:T}=y.useContext(j),S=[{id:"name",label:"Facility Manager Name"},{id:"email",label:"Facility Manager Email"},{id:"createdAt",label:"Joined ON"},{id:"facilityName",label:"Facility"},{id:"action",label:"Actions"}],R=()=>{a(E)};return y.useEffect(()=>{a(E)},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:b.Top,children:[e.jsx("div",{children:e.jsxs("div",{className:b.Filter,children:[e.jsx("label",{children:e.jsx(v,{selectedFilters:h,handleFilter:f,availFilters:["name","email"],getData:a,url:E})}),e.jsx(D,{type:"text",placeholder:"search",ref:t,defaultValue:u,onChange:C=>T(C.target.value)}),e.jsx(F,{primary:!0,onClick:R,children:"Filter"})]})}),e.jsx(F,{primary:!0,onClick:s,children:"Add Facility Manager"})]}),e.jsx("div",{className:b.Table,children:e.jsx(B,{tableData:c,columnData:S})}),e.jsx(H,{count:M,setUrl:p,url:E,getData:a}),r&&e.jsx(se,{}),d&&n&&e.jsx(ne,{}),i&&e.jsx(le,{})]})},oe=re(ie);export{oe as default};
