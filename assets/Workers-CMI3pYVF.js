import{r as E,j as e,N as P,y as D,B as j,h as V,k as z,z as f,a as U,b as N,M as w,I as F,d as G,T as H,P as B}from"./index-D1Wk5fvR.js";import{g as q,a as v,d as Y,e as J}from"./worker.service-CgMnN6KT.js";const K="_Top_7hsgt_1",Q="_Filter_7hsgt_8",X="_Table_7hsgt_39",S={Top:K,Filter:Q,Table:X},Z={isLoading:!1,error:"",addModal:!1,editModal:!1,deleteModal:!1,reqHistoryModal:!1,selected:null,workersData:[],workersTableData:[],selectedFilters:[],searchValue:"",count:0,urlFilter:"page=0&size=5"},ee=(r,s)=>{switch(s.type){case"ADD_MODAL":return{...r,addModal:s.status,isLoading:!r.isLoading};case"EDIT_MODAL":return{...r,editModal:s.status,isLoading:!r.isLoading};case"DELETE_MODAL":return{...r,deleteModal:s.status,isLoading:!r.isLoading};case"GET_DATA":return{...r,isLoading:!0,error:""};case"GET_DATA_FAILED":return{...r,isLoading:!1,error:s.error};case"GET_DATA_SUCCESS":return{...r,isLoading:!1,workersTableData:s.data};case"SELECT":return{...r,selected:s.selected};case"SET_COUNT":return{...r,count:s.count};case"SET_FILTERS":return{...r,selectedFilters:s.data};case"SET_SEARCH":return{...r,searchValue:s.data};case"SET_URL_FILTER":return{...r,urlFilter:s.data};default:return r}},k=E.createContext(null),re=r=>s=>{const[l,t]=E.useReducer(ee,Z),i=()=>{t({type:"ADD_MODAL",status:!l.addModal})},o=()=>{t({type:"EDIT_MODAL",status:!0})},c=()=>{t({type:"EDIT_MODAL",status:!1})},u=()=>{t({type:"DELETE_MODAL",status:!0})},h=()=>{t({type:"DELETE_MODAL",status:!1})},n=a=>{t({type:"SELECT",selected:a})},m=a=>{const d=new URLSearchParams(a||l.urlFilter),[g,x]=[d.get("size"),d.get("page")],_=new URLSearchParams;_.set("page",`${x}`),_.set("size",`${g}`),l.searchValue&&_.set("search",l.searchValue||"");const I=l.selectedFilters.reduce(($,O)=>`${$}&fields=${O}`,"");A(_.toString()+I)},M=a=>{t({type:"SET_FILTERS",data:a})},T=(a,d)=>{const g=new URLSearchParams(l.urlFilter);g.set("size",`${a}`),g.set("page",`${d}`),m(g.toString())},p=a=>{t({type:"SET_SEARCH",data:a}),new URLSearchParams(l.urlFilter).set("search",a)},A=a=>{t({type:"SET_URL_FILTER",data:a})},y=a=>{t({type:"SET_COUNT",count:a})},L=a=>e.jsxs(e.Fragment,{children:[e.jsx(j,{primary:!0,onClick:()=>{n(a),o()},children:e.jsx(V,{})}),e.jsx(j,{danger:!0,onClick:()=>{n(a),u()},children:e.jsx(z,{})})]}),C={handleAddModal:i,hideEditModal:c,hideDeleteModal:h,handleSelect:n,getData:async a=>{try{t({type:"GET_DATA"});const d=await q(a);y(d.page.totalElements);const g=d.content.map(x=>({name:x.name,email:x.email,workplaceName:x.workplaceName,workstation:x.workstationCode,action:L(x),reqHistory:e.jsx(P,{to:"/"})}));console.log(d),t({type:"GET_DATA_SUCCESS",data:g})}catch{t({type:"GET_DATA_FAILED",error:"Could not Fetch the Workers"}),D.error("Could not Fetch the Workers")}},setFilter:M,handleFilterChange:m,handleUrlChange:T,updateSearch:p,setCount:y};return e.jsx(k.Provider,{value:{...l,...C},children:e.jsx(r,{...s})})},se="_Form_ecg43_1",te="_DeleteContainer_ecg43_8",b={Form:se,DeleteContainer:te},R=f.object({name:f.string({invalid_type_error:"Email must be String"}).min(2,{message:"name should contain atleast 2 chars"}),email:f.string({invalid_type_error:"location must be String"}).min(5,{message:"email should contain atleast 2 chars"}).email("INVALID_EMAIL")}),ae=({})=>{var u;const{handleAddModal:r,getData:s,urlFilter:l}=E.useContext(k),{register:t,handleSubmit:i,formState:o}=U({resolver:N(R)}),c=async h=>{try{const n=await v(h);if(!(n.status>=200&&n.status<300))throw Error("ADD unsuccessfull");s(l),D.success("Facility Manager Added ")}catch{D.error("Sorry!! Facility Manager Could not be Added")}finally{r()}};return e.jsx(w,{setShowModal:r,children:e.jsxs("form",{onSubmit:i(c),className:b.Form,children:[e.jsx("h2",{children:"Add Worker"}),e.jsx(F,{type:"text",placeholder:"Enter name",...t("name")}),!!o.errors.name&&e.jsx("small",{children:o.errors.name.message}),e.jsx(F,{type:"email",placeholder:"Enter email",...t("email")}),!!o.errors.email&&e.jsx("small",{children:(u=o.errors.email)==null?void 0:u.message}),e.jsx(j,{type:"submit",children:"Add"})]})})},le=({})=>{const{hideDeleteModal:r,getData:s,selected:l,urlFilter:t}=E.useContext(k),i=async()=>{try{const o=await Y(l.id);if(!(o.status>=200&&o.status<300))throw Error("DELETE unsuccessfull");s(t),D.success("Facilty Manager Deleted Successfully")}catch{D.error("Facilty Manager Deletion Failed")}finally{r()}};return e.jsx(w,{setShowModal:r,children:e.jsxs("div",{className:b.DeleteContainer,children:[e.jsx("h2",{children:"Delete Worker"}),e.jsx("h5",{children:"Are You sure you want to delete this Workers?"}),e.jsx(j,{danger:!0,onClick:i,children:"DELETE"})]})})},oe=({})=>{var h;const{hideEditModal:r,getData:s,selected:l,urlFilter:t}=E.useContext(k),{register:i,handleSubmit:o,formState:c}=U({defaultValues:{name:`${l.name}`,email:`${l.email}`},resolver:N(R)}),u=async n=>{try{const m=await J(n,l.id);if(!(m.status>=200&&m.status<300))throw Error("EDIT unsuccessfull");s(t),D.success("Worker Edited ")}catch{D.error("Sorry!! Worker Could not be Edited")}finally{r()}};return e.jsx(w,{setShowModal:r,children:e.jsxs("form",{onSubmit:o(u),className:b.Form,children:[e.jsx("h2",{children:"Edit Wormker"}),e.jsxs("div",{children:[e.jsx("label",{children:"Worker Name"}),e.jsx(F,{placeholder:"Enter Worker Name",...i("name")}),!!c.errors.name&&e.jsx("small",{children:c.errors.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Worker Email"}),e.jsx(F,{placeholder:"Enter Worker Email",...i("email")}),!!c.errors.email&&e.jsx("small",{children:(h=c.errors.email)==null?void 0:h.message})]}),e.jsx(j,{type:"submit",children:"Edit"})]})})},ne=({})=>{const r=E.useRef(null),{getData:s,handleAddModal:l,addModal:t,deleteModal:i,editModal:o,workersTableData:c,selected:u,setFilter:h,searchValue:n,selectedFilters:m,count:M,urlFilter:T,handleUrlChange:p,handleFilterChange:A,updateSearch:y}=E.useContext(k),L=[{id:"name",label:"WorkPlace Manager Name"},{id:"email",label:"WorkPlace Manager Email"},{id:"workplaceName",label:"workplace Name"},{id:"workstationCode",label:"WorkStation"},{id:"action",label:"Actions"}],W=()=>{A(),s(T)};return E.useEffect(()=>{s(T)},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:S.Top,children:[e.jsx("div",{children:e.jsxs("div",{className:S.Filter,children:[e.jsx("label",{children:e.jsx(G,{selectedFilters:m,handleFilter:h,availFilters:["name","email"],getData:s,url:T})}),e.jsx(F,{type:"text",placeholder:"search",ref:r,defaultValue:n,onChange:C=>y(C.target.value)}),e.jsx(j,{primary:!0,onClick:W,children:"Filter"})]})}),e.jsx(j,{primary:!0,onClick:l,children:"Add Worker"})]}),e.jsx("div",{className:S.Table,children:e.jsx(H,{tableData:c,columnData:L})}),e.jsx(B,{count:M,setUrl:p,url:T,getData:s}),t&&e.jsx(ae,{}),u&&o&&e.jsx(oe,{}),i&&e.jsx(le,{})]})},de=re(ne);export{de as default};
