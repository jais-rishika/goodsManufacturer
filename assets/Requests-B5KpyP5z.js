import{r as d,j as s,d as U,I as y,B as f,T as j,P as C}from"./index-BWAck-FT.js";import{g as N}from"./Requests.service-B3YUrYuM.js";import{R as b}from"./ReqToolModal-1StJZsBY.js";const A="_Top_44ts4_1",M="_Filter_44ts4_8",L="_Table_44ts4_44",_={Top:A,Filter:M,Table:L},P=e=>{const a=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return`${a}-${n}-${l}`},I={ReqDetailModal:!1,RequestsData:[],selectedRequest:null,selectedFilters:[],searchValue:"",minDate:"2025-01-20",maxDate:`${P(new Date)}`,count:0,urlFilter:"page=0&size=5"},$=(e,a)=>{switch(a.type){case"SHOW_REQUEST_DETAILS":return{...e,ReqDetailModal:!e.ReqDetailModal};case"UPDATE_REQUESTS":return{...e,RequestsData:a.data};case"SELECT_REQUEST":return{...e,selectedRequest:a.data};case"SET_COUNT":return{...e,count:a.count};case"SET_FILTERS":return{...e,selectedFilters:a.data};case"SET_SEARCH":return{...e,searchValue:a.data};case"SET_MINDATE":return{...e,minDate:a.data};case"SET_MAXDATE":return{...e,maxDate:a.data};case"SET_URL_FILTER":return{...e,urlFilter:a.data};default:return e}},q=d.createContext(null),Q=e=>a=>{const[n,l]=d.useReducer($,I),R=()=>{l({type:"SHOW_REQUEST_DETAILS"})},S=t=>{const c=t.includes("toolName"),r=t.filter(u=>u!="toolName");r.length>1&&r.splice(0,1),c&&r.push("toolName"),l({type:"SET_FILTERS",data:r})},D=(t,c)=>{const r=new URLSearchParams(n.urlFilter);r.set("size",`${t}`),r.set("page",`${c}`),E(r.toString())},i=t=>{l({type:"SET_SEARCH",data:t})},h=t=>{l({type:"SET_MINDATE",data:t})},m=t=>{l({type:"SET_MAXDATE",data:t})},E=t=>{const c=new URLSearchParams(t),[r,u]=[c.get("size"),c.get("page")],o=new URLSearchParams;o.set("page",`${u}`),o.set("size",`${r}`),n.selectedFilters.includes("toolName")&&o.set("toolName",`${n.searchValue}`),n.selectedFilters.includes("pending")&&o.set("approvalStatus","PENDING"),n.selectedFilters.includes("rejected")&&o.set("approvalStatus","REJECTED"),n.selectedFilters.includes("approved")&&o.set("approvalStatus","APPROVED");const x=o.toString();l({type:"SET_URL_FILTER",data:x}),T(x)},p=t=>{l({type:"SET_COUNT",count:t})},T=async t=>{try{const c=await N(t),r=c.content.map(u=>({...u,returnDate:u.returnDate.substring(0,10),requestDate:u.requestDate.substring(0,10)}));l({type:"UPDATE_REQUESTS",data:r}),p(c.page.totalElements)}catch{}},g={handleReqDetailModal:R,getData:T,setSelected:t=>{l({type:"SELECT_REQUEST",data:t})},updateUrl:E,handleFilterChange:S,handleUrlChange:D,updateSearch:i,updateMinDate:h,updateMaxDate:m,setCount:p};return s.jsx(q.Provider,{value:{...n,...g},children:s.jsx(e,{...a})})},w=({})=>{const e=d.useRef(null),{getData:a,ReqDetailModal:n,RequestsData:l,searchValue:R,selectedFilters:S,count:D,urlFilter:i,updateUrl:h,handleUrlChange:m,handleFilterChange:E,updateSearch:p}=d.useContext(q),T=[{id:"requestDate",label:"Request Date"},{id:"toolName",label:"Tool Name"},{id:"reqQuantity",label:"Quantity"},{id:"approvalStatus",label:"Approved Status Details"},{id:"returnDate",label:"Return Date"},{id:"returnStatus",label:"Return Status Details"}],F=()=>{h(i)};return d.useEffect(()=>{a(i)},[]),s.jsxs(s.Fragment,{children:[s.jsx("div",{className:_.Top,children:s.jsx("div",{children:s.jsxs("div",{className:_.Filter,children:[s.jsx("label",{children:s.jsx(U,{selectedFilters:S,handleFilter:E,availFilters:["toolName","rejected","approved","pending"],getData:a,url:i})}),s.jsx(y,{type:"text",placeholder:"search",ref:e,defaultValue:R,onChange:g=>p(g.target.value)}),s.jsx(f,{primary:!0,onClick:F,children:"Filter"})]})})}),s.jsx("div",{className:_.Table,children:s.jsx(j,{tableData:l,columnData:T})}),s.jsx(C,{count:D,setUrl:m,url:i,getData:a}),n&&s.jsx(b,{})]})},O=Q(w);export{O as default};
