import{r as x,j as n,w as O,z as I,a as F,M as A,I as P,B as M,b as j,y as C}from"./index-D1Wk5fvR.js";const N="_Form_1j5vs_1",U="_Inputs_1j5vs_8",q={Form:N,Inputs:U},f={isLoading:!1,error:"",reqToolModal:!1,reqTableData:[],ToolInventoryData:[],selectedTool:null,selectedFilters:[],searchValue:"",minPrice:10,maxPrice:1e4,count:0,urlFilter:"page=0&size=5"},D=(t,s)=>{switch(s.type){case"REQ_TABLE_DATA":return{...t,reqTableData:s.data};case"UPDATE_TOOLS":return{...t,ToolInventoryData:s.data};case"REQ_TOOL_MODAL":return{...t,reqToolModal:s.status};case"SELECT_TOOL":return{...t,selectedTool:s.data};case"SET_COUNT":return{...t,count:s.count};case"SET_FILTERS":return{...t,selectedFilters:s.data};case"SET_SEARCH":return{...t,searchValue:s.data};case"SET_MINPRICE":return{...t,minPrice:s.data};case"SET_MAXPRICE":return{...t,maxPrice:s.data};case"SET_URL_FILTER":return{...t,urlFilter:s.data};default:return t}},L=x.createContext(null),z=t=>s=>{const[o,r]=x.useReducer(D,f),y=()=>{r({type:"REQ_TOOL_MODAL",status:!0})},p=()=>{r({type:"REQ_TOOL_MODAL",status:!1})},c=e=>{if(e.includes("isPerishable")&&e.includes("notPerishable")){const a=e.findIndex(h=>h==="isPerishable"),l=e.findIndex(h=>h==="notPerishable");a>l?e.splice(l,1):e.splice(a,1)}r({type:"SET_FILTERS",data:e})},R=(e,a)=>{const l=new URLSearchParams(o.urlFilter);l.set("size",`${e}`),l.set("page",`${a}`),m(l.toString())},E=e=>{r({type:"SET_SEARCH",data:e})},T=e=>{r({type:"SET_MINPRICE",data:e})},i=e=>{r({type:"SET_MAXPRICE",data:e})},m=e=>{const a=new URLSearchParams(e),[l,h]=[a.get("size"),a.get("page")],u=new URLSearchParams;u.set("page",`${h}`),u.set("size",`${l}`),u.set("name",o.searchValue),o.selectedFilters.includes("isPerishable"),o.selectedFilters.includes("notPerishable");let _="";o.selectedFilters.includes("special")&&(_+="&category=SPECIAL"),o.selectedFilters.includes("normal")&&(_+="&category=NORMAL"),u.set("minPrice",`${o.minPrice}`||"10"),u.set("maxPrice",`${o.maxPrice}`||"10000");const S=u.toString()+_;r({type:"SET_URL_FILTER",data:S}),g(S)},d=e=>{r({type:"SET_COUNT",count:e})},g=async e=>{try{const a=await O(e);r({type:"UPDATE_TOOLS",data:a.content}),d(a.page.totalElements)}catch(a){console.log(a)}},b={showReqToolModal:y,hideReqToolModal:p,getData:g,setSelected:e=>{r({type:"SELECT_TOOL",data:e})},updateReqTable:e=>{const a=e;localStorage.setItem("reqTable",JSON.stringify(e)),r({type:"REQ_TABLE_DATA",data:a})},updateUrl:m,handleFilterChange:c,handleUrlChange:R,updateSearch:E,updateMinPrice:T,updateMaxPrice:i,setCount:d};return n.jsx(L.Provider,{value:{...o,...b},children:n.jsx(t,{...s})})},w=I.object({toolName:I.string({invalid_type_error:"Email must be String"}).min(2,{message:"name should contain atleast 2 chars"}),quantity:I.number().min(1,{message:"Quantity can't be less than 1"})}),B=()=>{var E;const{hideReqToolModal:t,updateReqTable:s,selectedTool:o,reqTableData:r}=x.useContext(L),{register:y,handleSubmit:p,formState:c}=F({resolver:j(w)}),R=async T=>{const i=[...r],m=i.findIndex(d=>d.id===o.toolId);if(m!==-1)i[m].qty+=T.quantity;else{const d={qty:+T.quantity,id:o.toolId,name:T.toolName};i.push(d)}s(i),C.success("Tool Added"),t()};return n.jsx(A,{setShowModal:t,children:n.jsxs("form",{onSubmit:p(R),className:q.Form,children:[n.jsx("h2",{children:"Req Tool To Workplaces"}),n.jsxs("div",{className:q.Inputs,children:[n.jsxs("div",{children:[n.jsx(P,{type:"text",value:o.toolName,...y("toolName")}),!!c.errors.toolName&&n.jsx("small",{children:c.errors.toolName.message})]}),n.jsxs("div",{children:[n.jsx(P,{type:"number",placeholder:"Enter Quantity",...y("quantity",{valueAsNumber:!0})}),!!c.errors.quantity&&n.jsx("small",{children:(E=c.errors.quantity)==null?void 0:E.message})]})]}),n.jsx(M,{type:"submit",children:"Req"})]})})};export{B as R,L as T,z as w};
