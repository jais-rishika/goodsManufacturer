import{r as A,j as e,g as w,z as E,a as R,b as O,M as N,I as h,B as F,e as $,y as S,f as k,d as V,C as z,i as B,h as H,k as X,P as Y}from"./index-C3qfdU6q.js";import{d as W}from"./Facility.service-w93qDamW.js";const q="_Top_1j305_1",G="_Filter_1j305_8",J="_PriceFilter_1j305_33",K="_ToolsCard_1j305_38",Q="_ToolActions_1j305_44",f={Top:q,Filter:G,PriceFilter:J,ToolsCard:K,ToolActions:Q},Z={isLoading:!1,error:"",toolsData:[],addModal:!1,deleteModal:!1,editModal:!1,selectedTool:null,selectedFilters:[],searchValue:"",minPrice:10,maxPrice:1e4,count:0,urlFilter:"page=0&size=5"},ee=(s,n)=>{switch(n.type){case"ADD_MODAL":return{...s,addModal:!s.addModal};case"DELETE_MODAL":return{...s,deleteModal:!s.deleteModal};case"EDIT_MODAL":return{...s,editModal:!s.editModal};case"SELECT_TOOL":return{...s,selectedTool:n.data};case"UPDATE TOOLS":return{...s,toolsData:n.data};case"SET_COUNT":return{...s,count:n.count};case"SET_FILTERS":return{...s,selectedFilters:n.data};case"SET_SEARCH":return{...s,searchValue:n.data};case"SET_MINPRICE":return{...s,minPrice:n.data};case"SET_MAXPRICE":return{...s,maxPrice:n.data};case"SET_URL_FILTER":return{...s,urlFilter:n.data};default:return s}},D=A.createContext(null),se=s=>n=>{const[r,l]=A.useReducer(ee,Z),c=()=>{l({type:"ADD_MODAL"})},i=()=>{l({type:"DELETE_MODAL"})},o=()=>{l({type:"EDIT_MODAL"})},y=a=>{if(a.includes("isPerishable")&&a.includes("notPerishable")){const u=a.findIndex(M=>M==="isPerishable"),p=a.findIndex(M=>M==="notPerishable");u>p?a.splice(p,1):a.splice(u,1)}l({type:"SET_FILTERS",data:a})},d=(a,u)=>{const p=new URLSearchParams(r.urlFilter);p.set("size",`${a}`),p.set("page",`${u}`),j(p.toString())},m=a=>{l({type:"SET_SEARCH",data:a})},_=a=>{l({type:"SET_MINPRICE",data:a})},T=a=>{l({type:"SET_MAXPRICE",data:a})},j=a=>{const u=new URLSearchParams(a),[p,M]=[u.get("size"),u.get("page")],P=new URLSearchParams;P.set("page",`${M}`),P.set("size",`${p}`),r.selectedFilters.includes("name")&&P.set("name",r.searchValue);let I="";r.selectedFilters.includes("isPerishable")&&(P.set("isPerishable",`${r.selectedFilters.includes("isPerishable")}`),I+="&isPerishable=true"),r.selectedFilters.includes("notPerishable")&&(P.set("isPerishable",`${r.selectedFilters.includes("isPerishable")}`),I+="&isPerishable=false");let t="";r.selectedFilters.includes("special")&&(t+="&category=SPECIAL"),r.selectedFilters.includes("normal")&&(t+="&category=NORMAL"),P.set("minPrice",`${r.minPrice}`||"10"),P.set("maxPrice",`${r.maxPrice}`||"10000");const b=P.toString()+t+I;l({type:"SET_URL_FILTER",data:b}),g(b)},x=a=>{l({type:"SET_COUNT",count:a})},g=async a=>{try{const u=await w(a);l({type:"UPDATE TOOLS",data:u.content}),x(u.page.totalElements)}catch{}},L={handleAddModal:c,handleDeleteModal:i,handleEditModal:o,getData:g,setSelected:a=>{l({type:"SELECT_TOOL",data:a})},updateUrl:j,handleFilterChange:y,handleUrlChange:d,updateSearch:m,updateMinPrice:_,updateMaxPrice:T,setCount:x};return e.jsx(D.Provider,{value:{...r,...L},children:e.jsx(s,{...n})})},re="_Form_tyrv9_1",le="_Perishable_tyrv9_15",ae="_Select_tyrv9_20",C={Form:re,Perishable:le,Select:ae},U=E.object({name:E.string().min(3,{message:"name can't be less than 3"}),price:E.number().min(1,{message:"Price Cant be less than 1"}),fineAmount:E.number().min(0,{message:"Fine Amout Cant be less than 1"}).nullable(),category:E.enum(["NORMAL","SPECIAL"],{message:"Choose One Category"}),isPerishable:E.boolean(),returnPeriod:E.number().min(0,{message:"Return Period can't be less than 1"}).optional(),toolImage:E.custom().refine(s=>{if(!s||s.length===0)return!1},{message:"Please add Tool Image"}).refine(s=>{var r;return["image/png","image/jpeg","image/jpg"].includes(((r=s.item(0))==null?void 0:r.type)||"")},{message:"Wrong File Type"})}),te=({})=>{const{handleAddModal:s,getData:n,urlFilter:r}=A.useContext(D),{register:l,handleSubmit:c,formState:i,watch:o}=R({defaultValues:{returnPeriod:0},resolver:O(U)}),y=async d=>{const _=d.toolImage.item(0),T={name:d.name,price:d.price,category:d.category,fineAmount:d.fineAmount,isPerishable:d.isPerishable,returnPeriod:d.isPerishable?0:d.returnPeriod,toolImage:_},j=new FormData;for(let x in T)j.append(x,T[x]);try{await $(j),n(r),S.success("Tool Added ")}catch(x){console.log(x),S.error("Sorry!! Tool Could not be Added")}finally{s()}};return e.jsx(N,{setShowModal:s,children:e.jsxs("form",{onSubmit:c(y),className:C.Form,children:[e.jsx("h2",{children:"Add Tool"}),e.jsxs("div",{children:[e.jsx(h,{placeholder:"Enter Tool Name",...l("name")}),!!i.errors.name&&e.jsx("small",{children:i.errors.name.message})]}),e.jsxs("div",{className:C.Perishable,children:[e.jsx("label",{children:"Is Perishable: "}),e.jsx(h,{type:"checkbox",...l("isPerishable")}),!!i.errors.isPerishable&&e.jsx("small",{children:i.errors.isPerishable.message})]}),e.jsxs("div",{children:[e.jsx(h,{type:"number",placeholder:"Enter Price",...l("price",{valueAsNumber:!0})}),!!i.errors.price&&e.jsx("small",{children:i.errors.price.message})]}),e.jsxs("div",{children:[e.jsx(h,{type:"number",placeholder:"Enter Fine Amount",...l("fineAmount",{valueAsNumber:!0})}),!!i.errors.fineAmount&&e.jsx("small",{children:i.errors.fineAmount.message})]}),e.jsxs("div",{children:[e.jsxs("select",{...l("category"),className:C.Select,children:[e.jsx("option",{children:"Select Category"}),e.jsx("option",{value:"NORMAL",children:"NORMAL"}),e.jsx("option",{value:"SPECIAL",children:"SPECIAL"})]}),!!i.errors.category&&e.jsx("small",{children:i.errors.category.message})]}),!o("isPerishable")&&e.jsxs("div",{children:[e.jsx(h,{type:"number",defaultValue:0,placeholder:"Enter Return Period",...l("returnPeriod",{valueAsNumber:!0})}),!!i.errors.returnPeriod&&e.jsx("small",{children:i.errors.returnPeriod.message})]}),e.jsx(h,{type:"file",placeholder:"Choose Tool Image",...l("toolImage")}),e.jsx("div",{}),e.jsx(F,{type:"submit",children:"Add"})]})})},ne=({})=>{const{handleEditModal:s,getData:n,selectedTool:r,urlFilter:l}=A.useContext(D),{register:c,handleSubmit:i,formState:o,watch:y}=R({defaultValues:{name:`${r==null?void 0:r.name}`,price:r.price,fineAmount:r.fineAmount,category:r.category,isPerishable:!!r.isPerishable,returnPeriod:r.isPerishable?0:r.returnPeriod},resolver:O(U)}),d=async m=>{const T=m.toolImage.item(0),j={name:m.name,price:m.price,category:m.category,fineAmount:m.fineAmount,isPerishable:m.isPerishable,returnPeriod:m.returnPeriod,toolImage:T};console.log(j);const x=new FormData;for(let g in j)x.append(g,j[g]);try{await k(x,r.id),n(l),S.success("Tool  Edited ")}catch{S.error("Sorry!! Tool  Could not be Edited")}finally{s()}};return e.jsx(N,{setShowModal:s,children:e.jsxs("form",{onSubmit:i(d),className:C.Form,children:[e.jsx("h2",{children:"Edit Tool"}),e.jsxs("div",{children:[e.jsx("label",{children:"Tool Name: "}),e.jsx(h,{placeholder:"Enter Tool Name",...c("name")}),!!o.errors.name&&e.jsx("small",{children:o.errors.name.message})]}),e.jsxs("div",{className:C.Perishable,children:[e.jsx("label",{children:"Is Perishable: "}),e.jsx(h,{type:"checkbox",...c("isPerishable")}),!!o.errors.isPerishable&&e.jsx("small",{children:o.errors.isPerishable.message})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Price: "}),e.jsx(h,{type:"number",placeholder:"Enter Price",...c("price",{valueAsNumber:!0})}),!!o.errors.price&&e.jsx("small",{children:o.errors.price.message})]}),!y("isPerishable")&&e.jsxs("div",{children:[e.jsx("label",{children:"Fine"}),e.jsx(h,{type:"number",placeholder:"Enter Fine Amount",...c("fineAmount",{valueAsNumber:!0}),defaultValue:0}),!!o.errors.fineAmount&&e.jsx("small",{children:o.errors.fineAmount.message})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Category: "}),e.jsxs("select",{...c("category"),className:C.Select,children:[e.jsx("option",{children:"Select Category"}),e.jsx("option",{value:"NORMAL",children:"NORMAL"}),e.jsx("option",{value:"SPECIAL",children:"SPECIAL"})]}),!!o.errors.category&&e.jsx("small",{children:o.errors.category.message})]}),!y("isPerishable")&&e.jsxs("div",{children:[e.jsx("label",{children:"Return Period:"}),e.jsx(h,{type:"number",placeholder:"Enter Return Period",...c("returnPeriod",{valueAsNumber:!0})}),!!o.errors.returnPeriod&&e.jsx("small",{children:o.errors.returnPeriod.message})]}),e.jsx(F,{type:"submit",children:"Edit"})]})})},ie=({})=>{const{handleDeleteModal:s,getData:n,selectedTool:r,urlFilter:l}=A.useContext(D),c=async()=>{try{await W(r.id),n(l),S.success("Facilty Manager Deleted Successfully")}catch{S.error("Facilty Manager Deletion Failed")}finally{s()}};return e.jsx(N,{setShowModal:s,children:e.jsxs("div",{className:C.DeleteContainer,children:[e.jsx("h2",{children:"Delete Facility Manager"}),e.jsx("h5",{children:"Are You sure you want to delete this FacilityManager?"}),e.jsx(F,{danger:!0,onClick:c,children:"DELETE"})]})})},oe=({})=>{const s=A.useRef(null),{getData:n,setSelected:r,handleDeleteModal:l,handleEditModal:c,handleAddModal:i,toolsData:o,addModal:y,editModal:d,deleteModal:m,updateUrl:_,searchValue:T,selectedFilters:j,count:x,urlFilter:g,handleUrlChange:v,handleFilterChange:L,updateSearch:a,updateMaxPrice:u,updateMinPrice:p}=A.useContext(D),M=()=>{_(g)},P=t=>{const b=+t.target.value;console.log(b),b<1?(alert("Min value can't be less than 1"),t.target.value=""):p(b)},I=t=>{const b=+t.target.value;b<1?(alert("Max value can't be less than 1"),t.target.value=""):u(b)};return A.useEffect(()=>{n(g)},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:f.Top,children:[e.jsx("div",{children:e.jsxs("div",{className:f.Filter,children:[e.jsx("label",{children:e.jsx(V,{selectedFilters:j,handleFilter:L,availFilters:["name","special","normal","isPerishable"],getData:n,url:g})}),e.jsx(h,{type:"text",placeholder:"search",ref:s,defaultValue:T,onChange:t=>a(t.target.value)}),e.jsxs("div",{className:f.PriceFilter,children:[e.jsx(h,{placeholder:"MinPrice",type:"number",min:1,onChange:P,className:f.Price}),e.jsx(h,{placeholder:"MaxPrice",type:"number",min:1,onChange:I,className:f.Price})]}),e.jsx(F,{primary:!0,onClick:M,children:"Filter"})]})}),e.jsx(F,{primary:!0,onClick:i,children:"Add Tool"})]}),e.jsx("div",{className:f.ToolsCard,children:o.length>0&&o.map(t=>e.jsxs(z,{id:t.id,photo:t.toolImageUrl||B,children:[e.jsxs("p",{children:[e.jsx("span",{children:"Name:"}),e.jsx("span",{children:t.name})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Price:"}),e.jsx("span",{children:t.price})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Fine:"}),e.jsx("span",{children:t.fineAmount})]}),!t.isPerishable&&e.jsxs("p",{children:[e.jsx("span",{children:"Return Period:"}),e.jsx("span",{children:t.returnPeriod})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Category:"}),e.jsx("span",{children:t.category})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Perishable:"}),e.jsx("span",{children:t.isPerishable?"YES":"NO"})]}),e.jsxs("div",{className:f.ToolActions,children:[e.jsx(F,{primary:!0,onClick:()=>{r(t),c()},children:e.jsx(H,{})}),e.jsx(F,{danger:!0,onClick:()=>{r(t),l()},children:e.jsx(X,{})})]})]}))}),e.jsx(Y,{count:x,setUrl:v,url:g,getData:n}),y&&e.jsx(te,{}),d&&e.jsx(ne,{}),m&&e.jsx(ie,{})]})},he=se(oe);export{he as default};
