import{r as x,j as e,l as R,m as A,z as I,a as k,b as U,M as D,I as F,S as O,B as f,n as W,y as w,d as $,C as V,i as q,P as z}from"./index-C3qfdU6q.js";const B="_Top_ergt4_1",H="_Filter_ergt4_8",K="_PriceFilter_ergt4_33",Q="_ToolsCard_ergt4_38",y={Top:B,Filter:H,PriceFilter:K,ToolsCard:Q},X={isLoading:!1,error:"",sendToolModal:!1,ToolInventoryData:[],selectedTool:null,availFields:[],selectedWorkplace:null,selectedFilters:[],searchValue:"",minPrice:10,maxPrice:1e4,count:0,urlFilter:"page=0&size=5"},Y=(l,r)=>{switch(r.type){case"UPDATE_TOOLS":return{...l,ToolInventoryData:r.data};case"SEND_MODAL":return{...l,sendToolModal:!l.sendToolModal};case"SELECT_TOOL":return{...l,selectedTool:r.data};case"SET_AVAIL_FIELDS":return{...l,availFields:r.data};case"SET_WORKPLACE":return{...l,selectedWorkplace:r.data};case"SET_COUNT":return{...l,count:r.count};case"SET_FILTERS":return{...l,selectedFilters:r.data};case"SET_SEARCH":return{...l,searchValue:r.data};case"SET_MINPRICE":return{...l,minPrice:r.data};case"SET_MAXPRICE":return{...l,maxPrice:r.data};case"SET_URL_FILTER":return{...l,urlFilter:r.data};default:return l}},v=x.createContext(null),G=l=>r=>{const[c,n]=x.useReducer(Y,X),u=()=>{n({type:"SEND_MODAL"})},h=async s=>{const t=await R(s);console.log(t),n({type:"SET_AVAIL_FIELDS",data:t.content.map(d=>d.name)})},S=async s=>{n({type:"SET_WORKPLACE",data:s})},j=s=>{if(s.includes("isPerishable")&&s.includes("notPerishable")){const t=s.findIndex(a=>a==="isPerishable"),d=s.findIndex(a=>a==="notPerishable");t>d?s.splice(d,1):s.splice(t,1)}n({type:"SET_FILTERS",data:s})},T=(s,t)=>{const d=new URLSearchParams(c.urlFilter);d.set("size",`${s}`),d.set("page",`${t}`),p(d.toString())},P=s=>{n({type:"SET_SEARCH",data:s})},i=s=>{n({type:"SET_MINPRICE",data:s})},E=s=>{n({type:"SET_MAXPRICE",data:s})},p=s=>{const t=new URLSearchParams(s),[d,a]=[t.get("size"),t.get("page")],o=new URLSearchParams;o.set("page",`${a}`),o.set("size",`${d}`),o.set("name",c.searchValue);let M="";c.selectedFilters.includes("isPerishable")&&(M+="&isPerishable=true"),c.selectedFilters.includes("notPerishable")&&(M+="&isPerishable=false");let b="";c.selectedFilters.includes("special")&&(b+="&category=SPECIAL"),c.selectedFilters.includes("normal")&&(b+="&category=NORMAL"),o.set("minPrice",`${c.minPrice}`||"0"),o.set("maxPrice",`${c.maxPrice}`||"10000000");const L=o.toString()+b+M;n({type:"SET_URL_FILTER",data:L}),g(L)},m=s=>{n({type:"SET_COUNT",count:s})},g=async s=>{try{const t=await A(s);n({type:"UPDATE_TOOLS",data:t.content}),m(t.page.totalElements)}catch(t){console.log(t)}},_={showSendToolModal:u,getData:g,setSelected:s=>{n({type:"SELECT_TOOL",data:s})},setAvailFields:h,updateWorkplace:S,updateUrl:p,handleFilterChange:j,handleUrlChange:T,updateSearch:P,updateMinPrice:i,updateMaxPrice:E,setCount:m};return e.jsx(v.Provider,{value:{...c,..._},children:e.jsx(l,{...r})})},J="_Form_1j5vs_1",Z="_Inputs_1j5vs_8",N={Form:J,Inputs:Z},ee=I.object({workplace:I.string({invalid_type_error:"Email must be String"}).min(2,{message:"name should contain atleast 2 chars"}).optional(),toolName:I.string({invalid_type_error:"Email must be String"}).min(2,{message:"name should contain atleast 2 chars"}),quantity:I.number().min(1,{message:"Quantity can't be less than 1"})}),se=()=>{var p,m;const{availFields:l,setAvailFields:r,selectedWorkplace:c,updateWorkplace:n,showSendToolModal:u,selectedTool:h,getData:S,urlFilter:j}=x.useContext(v),{register:T,handleSubmit:P,formState:i}=k({resolver:U(ee)}),E=async g=>{if(!c)return alert("ADD Workplace");const s={workplaceId:(await R("search=workplace-1&fields=name")).content.find(t=>t.name===c).id,toolId:h.id,quantity:g.quantity};try{const t=await W(s);if(!(t.status>=200&&t.status<300))throw Error("SEND unsuccessfull");S(j),w.success("Tool Send Success ")}catch{w.error("Sorry!! Tool Send Failed")}finally{u()}};return x.useEffect(()=>{r("")},[]),e.jsx(D,{setShowModal:u,children:e.jsxs("form",{onSubmit:P(E),className:N.Form,children:[e.jsx("h2",{children:"Send Tool To Workplaces"}),e.jsxs("div",{className:N.Inputs,children:[e.jsxs("div",{children:[e.jsx(F,{type:"text",value:h==null?void 0:h.name,...T("toolName")}),!!i.errors.toolName&&e.jsx("small",{children:i.errors.toolName.message})]}),e.jsxs("div",{children:[e.jsx(F,{type:"number",placeholder:"Enter Quantity",...T("quantity",{valueAsNumber:!0})}),!!i.errors.quantity&&e.jsx("small",{children:(p=i.errors.quantity)==null?void 0:p.message})]})]}),e.jsx(O,{setFieldValue:n,availFields:l,setAvailFields:r,toSearch:"workplace"}),!!i.errors.workplace&&e.jsx("small",{children:(m=i.errors.workplace)==null?void 0:m.message}),e.jsx(f,{type:"submit",children:"SEND"})]})})},ae=({})=>{const l=x.useRef(null),{ToolInventoryData:r,sendToolModal:c,showSendToolModal:n,getData:u,setSelected:h,updateUrl:S,searchValue:j,selectedFilters:T,count:P,urlFilter:i,handleUrlChange:E,handleFilterChange:p,updateSearch:m,updateMaxPrice:g,updateMinPrice:C}=x.useContext(v),_=()=>{S(i)},s=a=>{const o=+a.target.value;console.log(o),o<1?(alert("Min value can't be less than 1"),a.target.value=""):C(o)},t=a=>{const o=+a.target.value;o<1?(alert("Max value can't be less than 1"),a.target.value=""):g(o)},d=a=>{h(a),n()};return x.useEffect(()=>{u(i)},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:y.Top,children:e.jsx("div",{children:e.jsxs("div",{className:y.Filter,children:[e.jsx("label",{children:e.jsx($,{selectedFilters:T,handleFilter:p,availFilters:["name","special","normal","isPerishable","notPerishable"],getData:u,url:i})}),e.jsx(F,{type:"text",placeholder:"search",ref:l,defaultValue:j,onChange:a=>m(a.target.value)}),e.jsxs("div",{className:y.PriceFilter,children:[e.jsx(F,{placeholder:"MinPrice",type:"number",min:1,onChange:s,className:y.Price}),e.jsx(F,{placeholder:"MaxPrice",type:"number",min:1,onChange:t,className:y.Price})]}),e.jsx(f,{primary:!0,onClick:_,children:"Filter"})]})})}),e.jsx("div",{className:y.ToolsCard,children:r.length>0&&r.map((a,o)=>e.jsxs(V,{id:a.id,photo:a.toolImageUrl||q,children:[e.jsxs("p",{children:[e.jsx("span",{children:"Name:"}),e.jsx("span",{children:a.name})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Price:"}),e.jsx("span",{children:a.price})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Fine:"}),e.jsx("span",{children:a.fineAmount})]}),!a.isPerishable&&e.jsxs("p",{children:[e.jsx("span",{children:"Return Period:"}),e.jsx("span",{children:a.returnPeriod})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Category:"}),e.jsx("span",{children:a.category})]}),e.jsxs("p",{children:[e.jsx("span",{children:"Perishable:"}),e.jsx("span",{children:a.isPerishable?"YES":"NO"})]}),e.jsx(f,{primary:!0,onClick:()=>d(r[o]),children:"Send Tool"})]}))}),e.jsx(z,{count:P,setUrl:E,url:i,getData:u}),c&&e.jsx(se,{})]})},re=G(ae);export{re as default};
